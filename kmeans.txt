#Upload Dataset

# Cell 1
from google.colab import drive
drive.mount('/content/drive')

# Cell 2
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import silhouette_score

# Cell 3
file_path = "/content/drive/MyDrive/data.csv"
df = pd.read_csv(file_path)

print(df.head())
print(df.info())

# Cell 4
X = df.select_dtypes(include=['int64','float64'])
print(X.head())

# Cell 5
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Cell 6
wcss = []
for i in range(1,11):
    km = KMeans(n_clusters=i, init='k-means++', random_state=42)
    km.fit(X_scaled)
    wcss.append(km.inertia_)

plt.plot(range(1,11), wcss, marker='o')
plt.xlabel("Number of Clusters")
plt.ylabel("WCSS")
plt.title("Elbow Method")
plt.show()

# Cell 7
scores = []
for i in range(2,11):
    km = KMeans(n_clusters=i, random_state=42)
    labels = km.fit_predict(X_scaled)
    score = silhouette_score(X_scaled, labels)
    scores.append(score)

plt.plot(range(2,11), scores, marker='o')
plt.xlabel("K")
plt.ylabel("Silhouette Score")
plt.title("Silhouette Method")
plt.show()

print("Best K:", range(2,11)[scores.index(max(scores))])

# Cell 8
k = 3  # change based on elbow/silhouette
kmeans = KMeans(n_clusters=k, random_state=42)
clusters = kmeans.fit_predict(X_scaled)

df['Cluster'] = clusters
print(df.head())

# Cell 9
plt.scatter(X_scaled[:,0], X_scaled[:,1], c=clusters)
plt.xlabel("Feature 1")
plt.ylabel("Feature 2")
plt.title("K-Means Clusters")
plt.show()

# Cell 10
print("Centroids:\n", kmeans.cluster_centers_)

